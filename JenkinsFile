pipeline {
  agent {
    label 'portfolio-agent'
  }
  stages {
    stage ('Build') {
      steps {
        echo "Initializing Project Build"
        sh "docker build -t portfolio-image ."
        echo "Build Successful"
      }
    }
    stage ('Deploy') {
      steps {
        echo "Initializing Project Deploy"
        sh '''
          docker-compose -f /home/jenkins/agent2/workspace/my_server_pipeline_master/docker-compose.yml down || true
            docker-compose -f /home/jenkins/agent2/workspace/my_server_pipeline_master/docker-compose.yml up -d
          '''
        echo "Deploy Successful"
      }
    }
  }
  post {
    success {
      echo "Pipeline completed successfully!"
    }
    failure {
      echo "Pipeline failed. Check the logs for details."
    }
  }
}